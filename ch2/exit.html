<!doctype html>

<html>
    <head>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.2.8/d3.min.js"></script>
    </head>
    <body>
    </body>

    <script>
        let tweets = d3.json("../data/tweets.json", renderTweets)

        function renderTweets(data) {   
            
            let tweets = data.tweets
            
            tweets.forEach(d => { 
                d.impact = d.retweets.length + d.favorites.length 
                d.tweetTime = new Date(d.timestamp)
            })

            let maxImpact = d3.max(tweets, d => d.impact)

            let containerWidth = 500
            let containerHeight = 500

            let timeExtent = d3.extent(tweets, d => d.tweetTime)
            let xScale = d3.scaleTime().domain(timeExtent).range([20, 480])
            let yScale = d3.scaleLinear().domain([0, maxImpact]).range([0, 460])
            let colorScale = d3.scaleLinear().domain([0, maxImpact]).range(["white", "#75739F"])
            let radiusScale = d3.scaleLinear().domain([0, maxImpact]).range([1, 20])

            d3.select("body")
            .append("svg")
            .attr("height", containerHeight)
            .attr("width", containerWidth)
            .selectAll("circle")
            .data(tweets, JSON.stringify)
            .enter()
            .append("circle")
            .attr("class", "tweets")
            .attr("r", (d) => radiusScale(d.impact))
            .attr("cx", (d) => xScale(d.tweetTime))
            .attr("cy", (d) => containerHeight - yScale(d.impact))
            .attr("stroke-width", "1px")
            .attr("stroke", "#FE9922")
            .attr("fill", (d) => colorScale(d.impact))

            let filteredTweets = tweets.filter(d => d.impact > 0)

            d3.select("body")
                .select("svg")
                .selectAll("circle")
                .data(filteredTweets, (d) => JSON.stringify(d))
                .exit()
                .remove()


            d3.select
        }

    </script>
</html>
